{"remainingRequest":"/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/thread-loader/dist/cjs.js!/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/babel-loader/lib/index.js!/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/eslint-loader/index.js??ref--13-0!/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/src/class/Stage.js","dependencies":[{"path":"/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/src/class/Stage.js","mtime":1632295034727},{"path":"/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/cache-loader/dist/cjs.js","mtime":1589375722521},{"path":"/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/thread-loader/dist/cjs.js","mtime":1589375722540},{"path":"/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/babel-loader/lib/index.js","mtime":1607483830637},{"path":"/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/node_modules/eslint-loader/index.js","mtime":1589375721213}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMvemhhbmdqdW4vRG9jdW1lbnRzL3dvcmtzcGFjZS90ZXN0LXNwYWNlL3Bhb2x1L0dyb292ZVVJL2dyb292ZS16aGl3dS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy96aGFuZ2p1bi9Eb2N1bWVudHMvd29ya3NwYWNlL3Rlc3Qtc3BhY2UvcGFvbHUvR3Jvb3ZlVUkvZ3Jvb3ZlLXpoaXd1L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3poYW5nanVuL0RvY3VtZW50cy93b3Jrc3BhY2UvdGVzdC1zcGFjZS9wYW9sdS9Hcm9vdmVVSS9ncm9vdmUtemhpd3Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvVXNlcnMvemhhbmdqdW4vRG9jdW1lbnRzL3dvcmtzcGFjZS90ZXN0LXNwYWNlL3Bhb2x1L0dyb292ZVVJL2dyb292ZS16aGl3dS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWxsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7CmltcG9ydCBTdWJzY3JpYmUgZnJvbSAnQC9jbGFzcy9TdWJzY3JpYmUnOwoKdmFyIFN0YWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTdGFnZShyb290KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RhZ2UpOwoKICAgIGlmIChTdGFnZS5pbnN0YW5jZSkgewogICAgICByZXR1cm4gU3RhZ2UuaW5zdGFuY2U7CiAgICB9CgogICAgdGhpcy5yb29tID0gbmV3IEFycmF5KDUpLmZpbGwoMCkubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIG5ldyBBcnJheSg5KS5maWxsKG51bGwpOwogICAgfSk7CiAgICB0aGlzLmV2ZW50ID0gbmV3IFN1YnNjcmliZSgpOwogICAgdGhpcy5zdWJzY3JpYmUgPSBuZXcgU3Vic2NyaWJlKCk7CiAgICB0aGlzLnNwcml0ZUxpc3QgPSBbXTsKICAgIHRoaXMuem9tYmllTGlzdCA9IG5ldyBBcnJheSg1KS5maWxsKDApLm1hcChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0pOwogICAgdGhpcy5pbml0QXBwKCk7CiAgICByb290LmFwcGVuZENoaWxkKHRoaXMuYXBwLnZpZXcpOwogICAgdGhpcy5pbml0RXZlbnQoKTsKICAgIFN0YWdlLmluc3RhbmNlID0gdGhpczsKICB9CiAgLyoqCiAgICogaW5pdCBhcHAgb2YgcGl4aQogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFN0YWdlLCBbewogICAga2V5OiAiaW5pdEFwcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdEFwcCgpIHsKICAgICAgdGhpcy5hcHAgPSBuZXcgUElYSS5BcHBsaWNhdGlvbih7CiAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsCiAgICAgICAgd2lkdGg6IDQyMywKICAgICAgICBoZWlnaHQ6IDIzMAogICAgICB9KTsKICAgICAgdGhpcy5hcHAudmlldy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CiAgICAgIHRoaXMuYXBwLnZpZXcuc3R5bGUubGVmdCA9ICcyNTVweCc7CiAgICAgIHRoaXMuYXBwLnZpZXcuc3R5bGUudG9wID0gJzk2cHgnOwogICAgICB0aGlzLmFwcC52aWV3LnN0eWxlLmhlaWdodCA9ICcyMzBweCc7CiAgICAgIHRoaXMuYXBwLnZpZXcuc3R5bGUud2lkdGggPSAnNDIzcHgnOwogICAgfQogIH0sIHsKICAgIGtleTogImluaXRFdmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdEV2ZW50KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5ldmVudC5vbignZGVzdHJveScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMucmVtb3ZlU3ByaXRlKGUpOwogICAgICB9KTsKICAgICAgdGhpcy5ldmVudC5vbignbW91bnQnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzLmFkZFNwcml0ZShlKTsKICAgICAgfSk7CiAgICAgIHRoaXMuZXZlbnQub24oJ2FkZFRpY2tlcicsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMuYXBwLnRpY2tlci5hZGQoZSk7CiAgICAgIH0pOwogICAgICB0aGlzLmV2ZW50Lm9uKCdyZW1vdmVUaWNrZXInLCBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzLmFwcC50aWNrZXIucmVtb3ZlKGUpOwogICAgICB9KTsKICAgICAgdGhpcy5ldmVudC5vbignem9tYmllTW91bnQnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzLmFkZFpvbWJpZS5hcHBseShfdGhpcywgX3RvQ29uc3VtYWJsZUFycmF5KGUpKTsKICAgICAgfSk7CiAgICAgIHRoaXMuZXZlbnQub24oJ3JlbW92ZVpvbWJpZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMucmVtb3ZlWm9tYmllLmFwcGx5KF90aGlzLCBfdG9Db25zdW1hYmxlQXJyYXkoZSkpOwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICog5re75Yqg57K+54G1CiAgICAgKiBAcGFyYW0gYm9keQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZFNwcml0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkU3ByaXRlKGJvZHkpIHsKICAgICAgdGhpcy5zcHJpdGVMaXN0LnB1c2goYm9keSk7CiAgICAgIHRoaXMuYXBwLnN0YWdlLmFkZENoaWxkKGJvZHkuc3ByaXRlKTsKICAgICAgYm9keS5zdGFydFdvcmsoKTsKICAgIH0KICAgIC8qKgogICAgICogcmVtb3ZlIHRoZSBzcHJpdGUgZnJvbSBzdGFnZQogICAgICogQHBhcmFtIGJvZHkKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZW1vdmVTcHJpdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVNwcml0ZShib2R5KSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuc3ByaXRlTGlzdC5maW5kSW5kZXgoZnVuY3Rpb24gKHMpIHsKICAgICAgICByZXR1cm4gcy5pZCA9PT0gYm9keS5pZDsKICAgICAgfSk7CiAgICAgIHRoaXMuc3ByaXRlTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgICBib2R5LnNwcml0ZS5kZXN0cm95KCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldCBib2R5ICh2ZWdldGFibGUpIGluIHJvb20KICAgICAqIEBwYXJhbSBwb3NpdGlvblgKICAgICAqIEBwYXJhbSBwb3NpdGlvblkKICAgICAqIEBwYXJhbSB2ZWdldGFibGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZXRWZWdldGFibGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFZlZ2V0YWJsZShwb3NpdGlvblgsIHBvc2l0aW9uWSwgdmVnZXRhYmxlKSB7CiAgICAgIHRoaXMucm9vbVtwb3NpdGlvblhdW3Bvc2l0aW9uWV0gPSB2ZWdldGFibGU7CiAgICAgIHZlZ2V0YWJsZS5zZXRTcHJpdGUocG9zaXRpb25YLCBwb3NpdGlvblkpOwogICAgfQogIH0sIHsKICAgIGtleTogImFkZFpvbWJpZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkWm9tYmllKHpvbWJpZSwgeSkgewogICAgICB0aGlzLnpvbWJpZUxpc3RbeV0ucHVzaCh6b21iaWUpOwogICAgICB0aGlzLmFwcC5zdGFnZS5hZGRDaGlsZCh6b21iaWUuc3ByaXRlKTsKICAgICAgem9tYmllLnN0YXJ0V29yaygpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbW92ZVpvbWJpZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlWm9tYmllKHksIHpvbWJpZSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLnpvbWJpZUxpc3RbeV0uZmluZEluZGV4KGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIGkuaWQgPT09IHpvbWJpZS5pZDsKICAgICAgfSk7CiAgICAgIHRoaXMuem9tYmllTGlzdFt5XS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB6b21iaWUuc3ByaXRlLmRlc3Ryb3koKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBTdGFnZTsKfSgpOwoKX2RlZmluZVByb3BlcnR5KFN0YWdlLCAiaW5zdGFuY2UiLCB2b2lkIDApOwoKZXhwb3J0IHsgU3RhZ2UgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["/Users/zhangjun/Documents/workspace/test-space/paolu/GrooveUI/groove-zhiwu/src/class/Stage.js"],"names":["PIXI","Subscribe","Stage","root","instance","room","Array","fill","map","event","subscribe","spriteList","zombieList","initApp","appendChild","app","view","initEvent","Application","transparent","width","height","style","position","left","top","on","e","removeSprite","addSprite","ticker","add","remove","addZombie","removeZombie","body","push","stage","addChild","sprite","startWork","index","findIndex","s","id","splice","destroy","positionX","positionY","vegetable","setSprite","zombie","y","i"],"mappings":"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","sourcesContent":["import * as PIXI from 'pixi.js'\nimport Subscribe from '@/class/Subscribe'\n\nexport default class Stage {\n  static instance;\n  constructor(root) {\n    if (Stage.instance) {\n      return Stage.instance\n    }\n    this.room = new Array(5).fill(0).map(() => {\n      return new Array(9).fill(null)\n    })\n\n    this.event = new Subscribe()\n\n    this.subscribe = new Subscribe()\n    this.spriteList = []\n    this.zombieList = new Array(5).fill(0).map(() => {\n      return []\n    })\n    this.initApp()\n    root.appendChild(this.app.view)\n    this.initEvent()\n    Stage.instance = this\n  }\n\n  /**\n   * init app of pixi\n   */\n  initApp() {\n    this.app = new PIXI.Application({\n      transparent: true,\n      width: 423,\n      height: 230\n    })\n    this.app.view.style.position = 'absolute'\n    this.app.view.style.left = '255px'\n    this.app.view.style.top = '96px'\n    this.app.view.style.height = '230px'\n    this.app.view.style.width = '423px'\n  }\n  initEvent() {\n    this.event.on('destroy', (e) => {\n      this.removeSprite(e)\n    })\n\n    this.event.on('mount', (e) => {\n      this.addSprite(e)\n    })\n\n    this.event.on('addTicker', (e) => {\n      this.app.ticker.add(e)\n    })\n    this.event.on('removeTicker', (e) => {\n      this.app.ticker.remove(e)\n    })\n    this.event.on('zombieMount', (e) => {\n      this.addZombie(...e)\n    })\n    this.event.on('removeZombie', (e) => {\n      this.removeZombie(...e)\n    })\n  }\n\n  /**\n   * 添加精灵\n   * @param body\n   */\n  addSprite(body) {\n    this.spriteList.push(body)\n    this.app.stage.addChild(body.sprite)\n    body.startWork()\n  }\n\n  /**\n   * remove the sprite from stage\n   * @param body\n   */\n  removeSprite(body) {\n    const index = this.spriteList.findIndex(s => s.id === body.id)\n    this.spriteList.splice(index, 1)\n    body.sprite.destroy()\n  }\n\n  /**\n   * set body (vegetable) in room\n   * @param positionX\n   * @param positionY\n   * @param vegetable\n   */\n  setVegetable(positionX, positionY, vegetable) {\n    this.room[positionX][positionY] = vegetable\n    vegetable.setSprite(positionX, positionY)\n  }\n  addZombie(zombie, y) {\n    this.zombieList[y].push(zombie)\n    this.app.stage.addChild(zombie.sprite)\n    zombie.startWork()\n  }\n  removeZombie(y, zombie) {\n    let index = this.zombieList[y].findIndex((i) => {\n      return i.id === zombie.id\n    })\n    this.zombieList[y].splice(index, 1)\n    zombie.sprite.destroy()\n  }\n}\n"]}]}